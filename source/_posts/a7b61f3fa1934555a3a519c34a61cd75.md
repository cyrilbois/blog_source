---
layout: post
title: 使用 davfs2 挂载 webdav
abbrlink: a7b61f3fa1934555a3a519c34a61cd75
tags:
  - linux
  - webdav
date: 1670672789172
updated: 1671351234797
---

### 配置 davfs2

- 编辑 /etc/davfs2/davfs2.conf 取消以下项的注释并更改值

```bash
ignore_dav_header 1
use_locks 0
```

- 配置用户名/密码

编辑 /etc/davfs2/secrets 末尾添加

```bash
https://dav.jianguoyun.com/dav/ username password
# 也可以有子目录
https://dav.jianguoyun.com/dav/dir1 username password
https://dav.jianguoyun.com/dav/dir2 username password
```

### 手动挂载

```bash
#创建挂载路径
mkdir /webdav
#手动挂载
mount -t davfs https://dav.jianguoyun.com/dav/ /webdav/
```

手动挂载测试过没问题后配置开机自动挂载

### 自动挂载

编辑 /etc/fstab 末尾添加

```bash
https://dav.jianguoyun.com/dav/ /webdav/ davfs rw,user,sync,noauto,uid=idea,_netdev 0 0
```

编辑`etc/systemd/system/mnt-webdav-service.service`

```bash
[Unit]
Description=Mount WebDAV Service
After=network-online.target
Wants=network-online.target

[Service]
Type=oneshot
ExecStart=bash -c 'for i in {1..15}; do if ping -c 1 dav.jianguoyun.com; hen mount /webdav; break; else sleep 1; fi; done'
ExecStop=umount /webdav
RemainAfterExit=true

[Install]
WantedBy=default.target
```
