{"note":[{"id":"a7b61f3fa1934555a3a519c34a61cd75","title":"使用 davfs2 挂载 webdav","body":"### 配置 davfs2\r\n\r\n- 编辑 /etc/davfs2/davfs2.conf 取消以下项的注释并更改值\r\n\r\n```bash\r\nignore_dav_header 1\r\nuse_locks 0\r\n```\r\n\r\n- 配置用户名/密码\r\n\r\n编辑 /etc/davfs2/secrets 末尾添加\r\n\r\n```bash\r\nhttps://dav.jianguoyun.com/dav/ username password\r\n# 也可以有子目录\r\nhttps://dav.jianguoyun.com/dav/dir1 username password\r\nhttps://dav.jianguoyun.com/dav/dir2 username password\r\n```\r\n\r\n### 手动挂载\r\n\r\n```bash\r\n#创建挂载路径\r\nmkdir /webdav\r\n#手动挂载\r\nmount -t davfs https://dav.jianguoyun.com/dav/ /webdav/\r\n```\r\n\r\n手动挂载测试过没问题后配置开机自动挂载\r\n\r\n### 自动挂载\r\n\r\n编辑 /etc/fstab 末尾添加\r\n\r\n```bash\r\nhttps://dav.jianguoyun.com/dav/ /webdav/ davfs rw,user,sync,noauto,uid=idea,_netdev 0 0\r\n```\r\n\r\n编辑`etc/systemd/system/mnt-webdav-service.service`\r\n\r\n```bash\r\n[Unit]\r\nDescription=Mount WebDAV Service\r\nAfter=network-online.target\r\nWants=network-online.target\r\n\r\n[Service]\r\nType=oneshot\r\nExecStart=bash -c 'for i in {1..15}; do if ping -c 1 dav.jianguoyun.com; hen mount /webdav; break; else sleep 1; fi; done'\r\nExecStop=umount /webdav\r\nRemainAfterExit=true\r\n\r\n[Install]\r\nWantedBy=default.target\r\n```\r\n","createdTime":1670672789172,"updatedTime":1671351234797,"resources":[],"tags":[{"id":"6476ae726bf34e28b8f9f5e3345d7af0","title":"linux","parent_id":""},{"id":"af939074a9e34a099426f8eb244a74b9","title":"webdav","parent_id":""},{"id":"bc0486755a3b4115821089dff75175d0","title":"blog","parent_id":""}]},{"id":"ce1c7e8fd2f349fa8516d01e2af4fc00","title":"linux 上几种睡眠模式比较","body":"```bash\nsystemctl suspend                 -- Suspend the system\nsystemctl hibernate     -- Hibernate the system\nsystemctl suspend-then-hibernate  -- Suspend the system for a period of time, and then hibernate it\nsystemctl hybrid-sleep  -- Hibernate and suspend the system\n```\n\n## suspend\n\n普通的挂起（或者说睡眠），机器能以最快的速度被唤醒。不建议在笔记本不插电时使用，容易睡死(电池耗尽后丢失工作状态)。\n\n## hibernate\n\n普通的休眠，约等于完全关机，但会保留上次的内存状态到硬盘内，唤醒后再恢复。速度稍慢，好处是不用担心睡死（毕竟已经“完全关机”了:joy_cat:）。\n\n## suspend-then-hibernate\n\n先挂起，经过一段时间后系统自动唤醒并执行休眠操作。\n\n但默认的等待时间一般都比较长，（文档里说是 120min，`/etc/systemd/sleep.conf`里的默认配置写的是 180min），电池不给力的话，仍有睡死的风险，如使用此模式建议根据笔记本情况以及自己的需求设定一个较短的时间。\n\n## hybrid-sleep\n\n混合睡眠，suspend 的同时也把内存状态备份到硬盘，睡眠速度比 suspend 稍慢，唤醒速度大差不差，可以防止睡死。\n\n我起初以为它的效果只是 suspend 的同时也把内存状态备份到硬盘以避免睡死，但在实际使用时发现我的笔记本在 suspend 时仍会发热（而且发热量很可观，几乎比省电模式下空载还热了，耗电估计也小不了），但 hybrid-sleep 时几乎没有发热，我觉得它应该做了更多的处理。不排除 suspend 在我的本子上没有正常工作这个可能\n\n> 我发现我的笔记本在 suspend 时仍会发热（而且发热量很可观，几乎比省电模式下空载还热了，耗电估计也小不了），但 hybrid-sleep 时几乎没有发热（和在 Windows 11 下睡眠的表现差不多）。\n> suspend 是普通的挂起，hybrid-sleep 是混合睡眠，从文档里的的介绍来看混合睡眠只是比普通的挂起多了个保存内存状态到硬盘的操作，按理说它俩的功耗表现应该是一样的啊，是 hybrid-sleep 在控制功耗方面做了更多的处理，还是 suspend 在我的本子上没有正常工作呢？\n> <https://forum.suse.org.cn/t/topic/15224>\n\n## 解决\n\n```bash\n# /etc/systemd/sleep.conf\n[Sleep]\n#AllowSuspend=yes\n#AllowHibernation=yes\n#AllowSuspendThenHibernate=yes\n#AllowHybridSleep=yes\n#SuspendMode=\n#SuspendState=mem standby freeze\n#HibernateMode=platform shutdown\n#HibernateState=disk\n#HybridSleepMode=suspend platform shutdown\n#HybridSleepState=disk\n#HibernateDelaySec=180min\n\n# Disable useless items\nAllowHibernation=no\nAllowSuspendThenHibernate=no\n# Configure suspend as hybrid-sleep\nSuspendMode=suspend platform shutdown\nSuspendState=disk\n```\n","createdTime":1670672789090,"updatedTime":1671350378831,"resources":[],"tags":[{"id":"6476ae726bf34e28b8f9f5e3345d7af0","title":"linux","parent_id":""},{"id":"bc0486755a3b4115821089dff75175d0","title":"blog","parent_id":""}]}],"resource":[]}
